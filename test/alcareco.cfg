process d0phi = {

  # initialize MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.debugModules = { "BeamSpotAnalyzer" }

  #replace MessageLogger.cout.threshold = "DEBUG"
  
  #### input data ####
  source = PoolSource
  {
    untracked vstring fileNames = {

# /MinBias/CSA08_STARTUP_V2_TkAlMinBias_v1/ALCARECO
#'/store/mc/CSA08/MinBias/ALCARECO/STARTUP_V2_TkAlMinBias_v1/0016/002E3EE3-A71A-DD11-95A0-001617E30F4C.root',
#'/store/mc/CSA08/MinBias/ALCARECO/STARTUP_V2_TkAlMinBias_v1/0016/10B41337-A71A-DD11-8392-001D09F2516D.root'

# /MinBias/CSA08_STARTUP_V2_v1/RECO
#'/store/mc/CSA08/MinBias/RECO/STARTUP_V2_v1/0013/00ACF67A-251A-DD11-B39D-001D09F27003.root',
#'/store/mc/CSA08/MinBias/RECO/STARTUP_V2_v1/0013/022E5048-251A-DD11-B712-001617E30F4C.root'
#'/store/mc/CSA08/MinBias/RECO/STARTUP_V2_v1/0013/04AFDA4E-2F1A-DD11-92E2-000423D987FC.root'

# /JetET80/CSA08_STARTUP_V2_STARTUP_V2_v1/RECO
'/store/mc/CSA08/JetET80/RECO/STARTUP_V2_STARTUP_V2_v1/0022/00493083-6E1F-DD11-A286-0016177CA778.root',
'/store/mc/CSA08/JetET80/RECO/STARTUP_V2_STARTUP_V2_v1/0022/02786F0B-A81F-DD11-83DA-000423D986A8.root'
#'/store/mc/CSA08/JetET80/RECO/STARTUP_V2_STARTUP_V2_v1/0022/0A675BB0-6B1F-DD11-8DC3-000423D98E30.root',
#'/store/mc/CSA08/JetET80/RECO/STARTUP_V2_STARTUP_V2_v1/0022/0A94CE5A-711F-DD11-9AFC-001617C3B654.root',
#'/store/mc/CSA08/JetET80/RECO/STARTUP_V2_STARTUP_V2_v1/0022/0C09D55A-801F-DD11-BE16-000423D6B358.root'
    }
  
  }

  untracked PSet maxEvents = {untracked int32 input = 1500}

  
  # pick new misaligment

# to get all other latest and greatest conditions:
include "Configuration/StandardSequences/data/FrontierConditions_GlobalTag.cff"
replace GlobalTag.globaltag = "IDEAL_V1::All"

# ...but more recent alignment:
es_source trackerAlignment = poolDBESSource from "CalibTracker/Configuration/data/Common/PoolDBESSource.cfi"
# the constants are already in prodction DB:
replace trackerAlignment.connect="frontier://FrontierProd/CMS_COND_20X_ALIGNMENT"
replace trackerAlignment.toGet = {
       { string record = "TrackerAlignmentRcd"      string tag = "TrackerIdealGeometry200_v2" },
       { string record = "TrackerAlignmentErrorRcd" string tag = "TrackerIdealGeometryErrors200_v2" }
}
# preference above global tag
es_prefer trackerAlignment = PoolDBESSource {}

  # get beam spot needed to refit tracks
#include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
include "RecoVertex/BeamSpotProducer/data/BeamSpot.cff"

  # refit tracks
include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilderWithoutRefit.cfi"
include "RecoTracker/TrackProducer/data/RefitterWithMaterial.cff"
replace TrackRefitter.TTRHBuilder = "WithoutRefit"
#replace TrackRefitter.src = "ALCARECOTkAlMinBias"
# but matching for strip stereo should be done:
replace ttrhbwor.Matcher = "StandardMatcher"

  include "RecoVertex/BeamSpotProducer/data/d0_phi_analyzer.cff"
  replace d0_phi_analyzer.OutputFileName = "EarlyCollision.root"
  replace d0_phi_analyzer.BSAnalyzerParameters.TrackCollection = "TrackRefitter"
  replace d0_phi_analyzer.BSAnalyzerParameters.InputBeamWidth = 31.7e-4

  path p =
  {
    offlineBeamSpot,
    TrackRefitter,
    d0_phi_analyzer
  }

}
